{
  "description": "extract login fail user.name\nby mosy\nversion 1.0.0",
  "processors": [
    {
      "grok": {
        "field": "error.message",
        "patterns": [
          ".*?unable to authenticate user \\[(?<user.name>.*?)\\]"
        ],
        "ignore_missing": true,
        "if": "ctx.event?.action == \"user_login\" && ctx.event?.outcome == \"failure\" && ctx.user?.name == null",
        "ignore_failure": true
      }
    }
  ]
}