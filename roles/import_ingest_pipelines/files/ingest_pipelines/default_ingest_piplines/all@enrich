{
  "description": "by mosy\nV1.1.0",
  "version": 1,
  "processors": [
    {
      "pipeline": {
        "name": "network_direction@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.network?.direction == null && ctx?.enrich?.network_direction == 'true' && ctx?.source?.ip != null && ctx?.destination?.ip != null",
        "ignore_failure": true
      }
    },
    {
      "pipeline": {
        "name": "geo@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.enrich?.geo == 'true' && (ctx?.source?.ip != null || ctx?.destination?.ip != null || ctx?.client?.ip != null || ctx?.server?.ip != null)",
        "ignore_failure": true
      }
    },
    {
      "pipeline": {
        "name": "tld@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.enrich?.tld == 'true' && (ctx?.dns?.question?.name != null || ctx?.url?.domain != null )",
        "ignore_failure": true
      }
    },
    {
      "pipeline": {
        "name": "dga@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.enrich?.dga == 'true' && ctx?.dns?.question?.name != null",
        "ignore_failure": true
      }
    },
    {
      "pipeline": {
        "name": "user_agent@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.enrich?.user_agent == 'true' && ctx?.user_agent?.original != null",
        "ignore_failure": true
      }
    },
    {
      "pipeline": {
        "name": "naked_ip@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.enrich?.naked_ip == 'true' && ctx?.url?.domain != null",
        "ignore_failure": true
      }
    },
    {
      "pipeline": {
        "name": "dns_question_name_length@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.enrich?.dns_question_name_length == 'true' && ctx?.dns?.question?.name != null",
        "ignore_failure": true
      }
    },
    {
      "pipeline": {
        "name": "url_length@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.enrich?.url_length == 'true' && (ctx?.url?.original != null || ctx?.url?.full != null)",
        "ignore_failure": true
      }
    },
    {
      "pipeline": {
        "name": "user_agent_length@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.enrich?.user_agent_length == 'true' && ctx?.user_agent?.original != null",
        "ignore_failure": true
      }
    },
    {
      "pipeline": {
        "name": "community_id@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.network?.community_id == null && ctx?.enrich?.community_id == 'true' && ( ctx?.source?.ip != null && ctx?.source?.port != null && ctx?.destination?.ip != null && ctx?.destination?.port != null )",
        "ignore_failure": true
      }
    },
    {
      "pipeline": {
        "name": "uri_part@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.enrich?.uri_part == 'true' && ctx?.url?.original != null",
        "ignore_failure": true
      }
    },
    {
      "pipeline": {
        "name": "top_1m@enrich",
        "ignore_missing_pipeline": true,
        "if": "ctx?.enrich?.top_1m == 'true' && (ctx?.dns?.question?.name != null || ctx?.url?.domain != null)",
        "ignore_failure": true
      }
    },
    {
      "remove": {
        "field": [
          "enrich",
          "ioc",
          "enrich_activator"
        ],
        "ignore_missing": true,
        "ignore_failure": true
      }
    },
    {
      "append": {
        "field": "tags",
        "value": [
          "enrich_pipe"
        ],
        "ignore_failure": true
      }
    }
  ]
}