{
  "description": "geo ip enrichment\nby Mosy\nversion 1.0.0",
  "processors": [
    {
      "geoip": {
        "field": "source.ip",
        "target_field": "source.geo",
        "ignore_missing": true,
        "if": "ctx?.source?.ip != null && ctx?.source?.geo == null",
        "ignore_failure": true
      }
    },
    {
      "geoip": {
        "field": "source.ip",
        "target_field": "source.as",
        "database_file": "GeoLite2-ASN.mmdb",
        "properties": [
          "asn",
          "organization_name"
        ],
        "ignore_missing": true,
        "if": "ctx?.source?.ip != null && ctx?.source?.as == null",
        "ignore_failure": true
      }
    },
    {
      "geoip": {
        "field": "destination.ip",
        "target_field": "destination.geo",
        "ignore_missing": true,
        "if": "ctx?.destination?.ip != null && ctx?.destination?.geo == null",
        "ignore_failure": true
      }
    },
    {
      "geoip": {
        "field": "destination.ip",
        "target_field": "destination.as",
        "database_file": "GeoLite2-ASN.mmdb",
        "properties": [
          "asn",
          "organization_name"
        ],
        "ignore_missing": true,
        "if": "ctx?.destination?.ip != null && ctx?.destination?.as == null",
        "ignore_failure": true
      }
    },
    {
      "geoip": {
        "field": "client.ip",
        "target_field": "client.geo",
        "ignore_missing": true,
        "if": "ctx?.client?.ip != null && ctx?.client?.geo == null",
        "ignore_failure": true
      }
    },
    {
      "geoip": {
        "field": "client.ip",
        "target_field": "client.as",
        "database_file": "GeoLite2-ASN.mmdb",
        "properties": [
          "asn",
          "organization_name"
        ],
        "ignore_missing": true,
        "if": "ctx?.client?.ip != null && ctx?.client?.as == null",
        "ignore_failure": true
      }
    },
    {
      "geoip": {
        "field": "server.ip",
        "target_field": "server.geo",
        "ignore_missing": true,
        "if": "ctx?.server?.ip != null && ctx?.server?.geo == null",
        "ignore_failure": true
      }
    },
    {
      "geoip": {
        "field": "server.ip",
        "target_field": "server.as",
        "database_file": "GeoLite2-ASN.mmdb",
        "properties": [
          "asn",
          "organization_name"
        ],
        "ignore_missing": true,
        "if": "ctx?.server?.ip != null && ctx?.server?.as == null",
        "ignore_failure": true
      }
    }
  ]
}