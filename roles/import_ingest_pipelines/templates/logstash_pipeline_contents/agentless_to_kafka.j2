input {\n\telastic_agent {\n\t\tport => 5049\n\t\tssl => true\n\t\tssl_certificate_authorities => [\"/etc/logstash/certs/ca.crt\"]\n\t\tssl_certificate => \"/etc/logstash/certs/logstash.crt\"\n\t\tssl_key => \"/etc/logstash/certs/logstash.pkcs8.key\"\n\t\tssl_verify_mode => \"none\"\n\t\texecutor_threads => 4\n\t\tclient_inactivity_timeout => 1200\n\t\tadd_field => { \"[@metadata][agentless]\" => true }\n\t}\n}\n\nfilter {\n\n    if [event][original] and [message] {\n        mutate {\n            remove_field => [\"[event][original]\"]\n        }\n    }\n\t\n    else{}\n\t\n    if [@metadata][agentless] and [log][source][address] {\n        mutate {\n            split => { \"[log][source][address]\" => \":\" }\n        }\n        mutate {\n            rename => {\n                \"[log][source][address][0]\" => \"sensor.ip\" \n                \"[log][source][address][1]\" => \"sensor_source_port\"\n            }\n            remove_field => [ \"[agent]\", \"[host][os]\", \"[host][ip]\", \"[host][mac]\", \"[host][architecture]\", \"[host][containerized]\", \"[elastic_agent]\" ]\n        }\n        mutate {\n            remove_field => [ \"[log][source][address]\" ]\n        }\n    }\n\n    # if [data_stream][dataset] == \"multi_syslog\" {}\n}\n\noutput {\n \n    if [data_stream][type] == \"metrics\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_metrics\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_metrics\"\n        }          \n    }\n \n    else if [data_stream][dataset] == \"fortinet_fortigate.log\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_fortigate\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_fortigate\"\n        }\n    }\n\t\n    else if [data_stream][dataset] == \"cisco_asa.log\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_cisco_asa\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_cisco_asa\"\n        }\n    }\n\t\n    else if [data_stream][dataset] =~ \"^zeek\\.\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_zeek\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_zeek\"\n        }        \n    }\n\t\n    else if [data_stream][dataset] == \"cisco_ftd.log\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_cisco_ftd\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_cisco_ftd\"\n        }\n    }\n\t\n    else if [data_stream][dataset] == \"fortiweb\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_fortiweb\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_fortiweb\"\n        }\n    }\n\n    else if [data_stream][dataset] == \"sophos\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_sophos\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_sophos\"\n        }        \n    }\n\n    else if [data_stream][dataset] == \"apkgate\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_apkgate\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_apkgate\"\n        }        \n    }\n\n    else if [data_stream][dataset] == \"juniper_srx.log\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_juniper\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_juniper\"\n        }\n    }\n\t\n    else if [data_stream][dataset] == \"netflow.log\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_netflow\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_netflow\"\n        }        \n    }\n\t\n    else if [data_stream][dataset] == \"vsphere.log\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_vsphere\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_vsphere\"\n        }        \n    }\n\t\n    else if [data_stream][dataset] == \"suricata.eve\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_suricata\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_suricata\"\n        }          \n    }\n\t\n    else if [data_stream][dataset] == \"kaspersky\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_kaspersky\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_kaspersky\"\n        }        \n    }\n\n\t\n    else if [data_stream][dataset] == \"padvish\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_padvish\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_padvish\"\n        }        \n    }\n\t\n    else if [data_stream][dataset] == \"cisco_ios.log\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_cisco_ios\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_cisco_ios\"\n        }        \n    }\n\n    else {\n        kafka {\n            codec => json\n            id => \"kafka_input_other\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_other\"\n        }          \n    }\n}