input {\n\telastic_agent {\n\t\tport => 5046\n\t\tssl => true\n\t\tssl_certificate_authorities => [\"/etc/logstash/certs/ca.crt\"]\n\t\tssl_certificate => \"/etc/logstash/certs/logstash.crt\"\n\t\tssl_key => \"/etc/logstash/certs/logstash.pkcs8.key\"\n\t\tssl_verify_mode => \"none\"\n\t\texecutor_threads => 4\n\t\tclient_inactivity_timeout => 1200\n\t\tadd_field => { \"[@metadata][nba]\" => true }\n\t}\n}\n\nfilter {\n\n    if [event][original] and [message] {\n        mutate {\n            remove_field => [\"[event][original]\"]\n        }\n    }\n\t\n    else{}\n\t\n}\n\noutput {\n\n    if [data_stream][type] == \"metrics\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_metrics\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_metrics\"\n        }          \n    }\n    \n    else if [data_stream][dataset] =~ \"^zeek\\.\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_zeek\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_zeek\"\n        }        \n    }\n\t\n    else if [data_stream][dataset] == \"suricata.eve\" {\n        kafka {\n            codec => json\n            id => \"kafka_input_suricata\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_suricata\"\n        }          \n    }\n\n    else {\n        kafka {\n            codec => json\n            id => \"kafka_input_other\"\n            bootstrap_servers => \"localhost:9094\"\n            partitioner => \"uniform_sticky\"\n            topic_id => \"in_other\"\n        }          \n    }\n}