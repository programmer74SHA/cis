{
  "id": "microsoft_sqlserver-windows-web-db-default",
  "name": "microsoft_sqlserver (windows-web-db-default)",
  "namespace": "",
  "policy_id": "windows-web-db-default",
  "package": {
    "name": "microsoft_sqlserver",
    "version": ""
  },
  "inputs": [
    {
      "type": "winlog",
      "policy_template": "audit_logs",
      "enabled": true,
      "streams": [
        {
          "enabled": true,
          "data_stream": {
            "type": "logs",
            "dataset": "microsoft_sqlserver.audit"
          },
          "vars": {
            "preserve_original_event": {
              "type": "bool",
              "value": true
            },
            "event_id": {
              "value": 33205,
              "type": "text"
            },
            "channel": {
              "type": "text",
              "value": "Application"
            },
            "ignore_older": {
              "value": "72h",
              "type": "text"
            },
            "language": {
              "value": 0,
              "type": "text"
            },
            "tags": {
              "value": [],
              "type": "text"
            },
            "processors": {
              "type": "yaml"
            }
          },
          "compiled_stream": {
            "name": "Application",
            "condition": "${host.platform} == 'windows'",
            "event_id": 33205,
            "ignore_older": "72h",
            "include_xml": true
          }
        }
      ]
    },
    {
      "type": "logfile",
      "policy_template": "audit_logs",
      "enabled": true,
      "streams": [
        {
          "enabled": true,
          "data_stream": {
            "type": "logs",
            "dataset": "microsoft_sqlserver.log"
          },
          "vars": {
            "paths": {
              "value": [
                "/var/opt/mssql/log/error*"
              ],
              "type": "text"
            },
            "encoding": {
              "type": "text"
            },
            "tags": {
              "value": [
                "mssql-logs"
              ],
              "type": "text"
            },
            "preserve_original_event": {
              "type": "bool",
              "value": true
            },
            "processors": {
              "type": "yaml"
            }
          },
          "compiled_stream": {
            "paths": [
              "/var/opt/mssql/log/error*"
            ],
            "tags": [
              "preserve_original_event",
              "mssql-logs"
            ],
            "exclude_files": [
              ".gz$"
            ],
            "multiline": {
              "pattern": "^\\d{4}-\\d{2}-\\d{2}",
              "negate": true,
              "match": "after"
            }
          }
        }
      ]
    },
    {
      "type": "sql/metrics",
      "policy_template": "audit_logs",
      "enabled": false,
      "streams": [
        {
          "enabled": false,
          "data_stream": {
            "type": "metrics",
            "dataset": "microsoft_sqlserver.performance"
          },
          "vars": {
            "period": {
              "value": "60s",
              "type": "text"
            },
            "dynamic_counter_name": {
              "value": "Memory Grants Pend%",
              "type": "text"
            }
          }
        },
        {
          "enabled": false,
          "data_stream": {
            "type": "metrics",
            "dataset": "microsoft_sqlserver.transaction_log"
          },
          "vars": {
            "period": {
              "value": "60s",
              "type": "text"
            },
            "databases": {
              "value": [
                "master",
                "model",
                "tempdb",
                "msdb"
              ],
              "type": "text"
            },
            "fetch_from_all_databases": {
              "value": false,
              "type": "bool"
            }
          }
        }
      ],
      "vars": {
        "hosts": {
          "value": [
            "localhost"
          ],
          "type": "text"
        },
        "password": {
          "type": "password",
          "value": ""
        },
        "username": {
          "type": "text",
          "value": ""
        }
      }
    }
  ]
}