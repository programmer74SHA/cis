{
  "id": "cisco_ios-ilb-collector-default",
  "name": "cisco_ios (ilb-collector-default)",
  "namespace": "",
  "policy_id": "ilb-collector-default",
  "enabled": true,
  "package": {
    "name": "cisco_ios",
    "version": ""
  },
  "inputs": [
    {
      "type": "tcp",
      "policy_template": "cisco_ios",
      "enabled": false,
      "streams": [
        {
          "enabled": false,
          "data_stream": {
            "type": "logs",
            "dataset": "cisco_ios.log"
          },
          "vars": {
            "tags": {
              "value": [
                "cisco-ios",
                "forwarded"
              ],
              "type": "text"
            },
            "syslog_host": {
              "value": "localhost",
              "type": "text"
            },
            "syslog_port": {
              "value": 9002,
              "type": "integer"
            },
            "preserve_original_event": {
              "value": false,
              "type": "bool"
            },
            "tz_offset": {
              "value": "UTC",
              "type": "text"
            },
            "tz_map": {
              "value": "#- tz_short: AEST\n#  tz_long: Australia/Sydney",
              "type": "yaml"
            },
            "processors": {
              "type": "yaml"
            },
            "ssl": {
              "value": "#certificate: \"/etc/server/cert.pem\"\n#key: \"/etc/server/key.pem\"",
              "type": "yaml"
            },
            "tcp_options": {
              "value": "#max_connections: 1\n#framing: delimiter\n#line_delimiter: \"\\n\"",
              "type": "yaml"
            }
          }
        }
      ]
    },
    {
      "type": "udp",
      "policy_template": "cisco_ios",
      "enabled": true,
      "streams": [
        {
          "enabled": true,
          "data_stream": {
            "type": "logs",
            "dataset": "cisco_ios.log"
          },
          "vars": {
            "tags": {
              "value": [
                "cisco-ios",
                "forwarded"
              ],
              "type": "text"
            },
            "syslog_host": {
              "type": "text",
              "value": "0.0.0.0"
            },
            "syslog_port": {
              "type": "integer",
              "value": "5520"
            },
            "preserve_original_event": {
              "type": "bool",
              "value": true
            },
            "tz_offset": {
              "value": "UTC",
              "type": "text"
            },
            "tz_map": {
              "value": "#- tz_short: AEST\n#  tz_long: Australia/Sydney",
              "type": "yaml"
            },
            "udp_options": {
              "value": "#read_buffer: 100MiB\n#max_message_size: 50KiB\n#timeout: 300s",
              "type": "yaml"
            },
            "processors": {
              "type": "yaml"
            }
          },
          "compiled_stream": {
            "host": "0.0.0.0:5520",
            "tags": [
              "preserve_original_event",
              "cisco-ios",
              "forwarded"
            ],
            "publisher_pipeline.disable_host": true,
            "fields_under_root": true,
            "fields": {
              "_conf": {
                "tz_offset": "UTC",
                "tz_map": null
              }
            },
            "processors": [
              {
                "add_locale": null
              }
            ]
          }
        }
      ]
    },
    {
      "type": "logfile",
      "policy_template": "cisco_ios",
      "enabled": false,
      "streams": [
        {
          "enabled": false,
          "data_stream": {
            "type": "logs",
            "dataset": "cisco_ios.log"
          },
          "vars": {
            "paths": {
              "value": [
                "/var/log/cisco-ios.log"
              ],
              "type": "text"
            },
            "tags": {
              "value": [
                "cisco-ios",
                "forwarded"
              ],
              "type": "text"
            },
            "preserve_original_event": {
              "value": false,
              "type": "bool"
            },
            "tz_offset": {
              "value": "UTC",
              "type": "text"
            },
            "tz_map": {
              "value": "#- tz_short: AEST\n#  tz_long: Australia/Sydney",
              "type": "yaml"
            },
            "processors": {
              "type": "yaml"
            }
          }
        }
      ]
    }
  ]
}