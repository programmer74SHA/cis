{
  "id": "oracle-linux-db-default",
  "name": "oracle (linux-db-default)",
  "namespace": "",
  "policy_id": "linux-db-default",
  "enabled": true,
  "package": {
    "name": "oracle",
    "version": ""
  },
  "inputs": [
    {
      "type": "filestream",
      "policy_template": "oracle",
      "enabled": true,
      "streams": [
        {
          "enabled": true,
          "data_stream": {
            "type": "logs",
            "dataset": "oracle.database_audit"
          },
          "vars": {
            "paths": {
              "value": [
                "/home/user/oracleauditlogs/*.aud"
              ],
              "type": "text"
            },
            "tags": {
              "value": [
                "oracle-database_audit"
              ],
              "type": "text"
            },
            "preserve_original_event": {
              "type": "bool",
              "value": true
            },
            "processors": {
              "type": "yaml"
            }
          },
          "compiled_stream": {
            "paths": [
              "/home/user/oracleauditlogs/*.aud"
            ],
            "parsers": [
              {
                "multiline": {
                  "type": "pattern",
                  "pattern": "^[A-Za-z]{3}\\s+[A-Za-z]{3}\\s+[0-9]{1,2}\\s[0-9]{2}:[0-9]{2}:[0-9]{2}\\s[0-9]{4}\\s\\S[0-9]{2}:[0-9]{2}",
                  "negate": true,
                  "match": "after",
                  "timeout": 10
                }
              }
            ],
            "exclude_lines": [
              "^Audit file"
            ],
            "tags": [
              "preserve_original_event",
              "oracle-database_audit"
            ],
            "exclude_files": [
              ".gz$"
            ],
            "processors": [
              {
                "add_locale": null
              }
            ]
          }
        }
      ]
    },
    {
      "type": "sql/metrics",
      "policy_template": "oracle",
      "enabled": false,
      "streams": [
        {
          "enabled": false,
          "data_stream": {
            "type": "metrics",
            "dataset": "oracle.memory"
          },
          "vars": {
            "period": {
              "value": "60s",
              "type": "text"
            },
            "tags": {
              "value": [
                "oracle_memory_metrics"
              ],
              "type": "text"
            },
            "processors": {
              "type": "yaml"
            }
          }
        },
        {
          "enabled": false,
          "data_stream": {
            "type": "metrics",
            "dataset": "oracle.performance"
          },
          "vars": {
            "period": {
              "value": "60s",
              "type": "text"
            },
            "tags": {
              "value": [
                "oracle_performance"
              ],
              "type": "text"
            },
            "processors": {
              "type": "yaml"
            }
          }
        },
        {
          "enabled": false,
          "data_stream": {
            "type": "metrics",
            "dataset": "oracle.sysmetric"
          },
          "vars": {
            "period": {
              "value": "60s",
              "type": "text"
            },
            "dynamic_metric_name_filter": {
              "value": "%",
              "type": "text"
            },
            "tags": {
              "value": [
                "oracle_sysmetrics"
              ],
              "type": "text"
            },
            "processors": {
              "type": "yaml"
            }
          }
        },
        {
          "enabled": false,
          "data_stream": {
            "type": "metrics",
            "dataset": "oracle.system_statistics"
          },
          "vars": {
            "period": {
              "value": "60s",
              "type": "text"
            },
            "tags": {
              "value": [
                "oracle_system_statistics_metrics"
              ],
              "type": "text"
            },
            "processors": {
              "type": "yaml"
            }
          }
        },
        {
          "enabled": false,
          "data_stream": {
            "type": "metrics",
            "dataset": "oracle.tablespace"
          },
          "vars": {
            "period": {
              "value": "60s",
              "type": "text"
            },
            "tags": {
              "value": [
                "oracle_tablespace"
              ],
              "type": "text"
            },
            "processors": {
              "type": "yaml"
            }
          }
        }
      ],
      "vars": {
        "hosts": {
          "value": [
            "oracle://0.0.0.0:1521/ORCLCDB.localdomain?sysdba=1"
          ],
          "type": "text"
        },
        "username": {
          "type": "text"
        },
        "password": {
          "type": "password"
        }
      }
    }
  ]
}